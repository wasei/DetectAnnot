# 物体検出モデル学習プロジェクト

Unreal Engine で生成した画像データを用いて物体検出モデルを学習し、その有効性を検証するためのサブプロジェクトです。  
本プロジェクトは、Unreal Engine 上で生成されるデータセットが機械学習に有効かどうかを確認することを目的としています。

## プロジェクト構成

```
├── main.py             # メインスクリプト
├── dataset.py          # データセットクラス
├── model.py            # モデル定義と管理
├── train.py            # 学習処理のコード
├── transforms.py       # 画像変換処理
└── visualization.py    # 可視化用ユーティリティ
```

## 検証内容と結果　

今回は、以下の 3 種類の画像を比較することで、Unreal Engine で生成した画像を用いて学習した物体検出モデルの有効性を簡易的に検証しました。

- 学習前の推論結果（閾値なし）

  ![学習前](docs/images/compare_unfiltered_before_after.jpg)  
  未学習の状態では、すべてのバウンディングボックスが表示され、誤検出が多く見られました。

- 学習後の推論結果（閾値 0.5 適用）

  ![学習後（合成画像）](docs/images/result_filtered_synthetic.jpg)  
  多少のズレはあるものの、対象物をある程度正確な検出ができるようになりました。

- 実写画像に対する推論結果（学習後）

  ![学習後（実写画像）](docs/images/result_filtered_real.jpg)  
  現実の画像に対しても、限定的ではありますが検出が可能であることを確認しました。

> ※ モデルには Faster R-CNN を使用しましたが、今回はモデルの最適性や比較・調整は目的としていません。

## 使い方

### 実行方法

以下のコマンドで学習と評価を実行します。

```bash
python main.py
```

## データセット構成

- 学習画像は `./dataset/images` に格納
- テスト画像は `./dataset/test_images` に格納
- アノテーションは `./annotations.json` に格納（COCO フォーマット）
